### 职责链模式

*created by 付果果  2019.12.16  9:50*

##### 介绍

```javascript
责任链模式（Chain of Responsibility）的定义：为了避免请求发送者与多个请求处理者耦合在一起，将所有
请求的处理者通过前一对象记住其下一个对象的引用而连成一条链；当有请求发生时，可将请求沿着这条链传
递，直到有对象处理它为止。
```

###### 责任链模式也叫职责链模式。 

##### 应用场景

```
1. 多个对象可以处理同一个请求，但具体由哪个对象处理则在运行时动态决定。
2. 在请求处理者不明确的情况下，向多个处理者中的一个提交请求。
3. 需要动态处理一组对象处理请求。
4. 可动态的添加新的处理者
```

##### **优点** 

```
1、降低了对象之间的耦合度。该模式使得一个对象无须知道到底是哪一个对象处理其请求以及链的结构，发送者
和接收者也无须拥有对方的明确信息。
2、增强了系统的可扩展性。可以根据需要增加新的请求处理类，满足开闭原则。
3、增强了给对象指派职责的灵活性。当工作流程发生变化，可以动态地改变链内的成员或者调动它们的次序，也
可动态地新增或者删除责任。
4、责任链简化了对象之间的连接。每个对象只需保持一个指向其后继者的引用，不需保持其他所有处理者的引
用，这避免了使用众多的 if 或者 if···else 语句。
5、责任分担。每个类只需要处理自己该处理的工作，不该处理的传递给下一个对象完成，明确各类的责任范围，
符合类的单一职责原则
```

##### 缺点

```
1、不能保证每个请求一定被处理。由于一个请求没有明确的接收者，所以不能保证它一定会被处理，该请求可能一直传到链的末端都得不到处理。
2、对比较长的职责链，请求的处理可能涉及多个处理对象，系统性能将受到一定影响。
3、职责链建立的合理性要靠客户端来保证，增加了客户端的复杂性，可能会由于职责链的错误设置而导致系统出错，如可能会造成循环调用。
```

##### 代码实现

###### case：我们研发部同学要采购一批物资，在oa上走流程； 

######         1、首先到了采购部，金额太大，得上报总经理；小于1 000元；

######         2、总经理一看，金额太大，得上报董事长； 小于10 000元

######         3、董事长一看，同意。 

######         A ->  B  ->  C  -> .......

```
    // 处理类
    class Handler {
        constructor() {
            this.next = null;
        }
        // 设置下一个处理人
        setNext(handler) {
            this.next = handler;
        }
        // 获取处理结果
        handleRes() {
            throw new Error('该方法未被重写');
        }
    }
    // 采购部
    class CGBHandler extends Handler {
        handleRes(money) {
            if (money < 1000) {
                console.log('同意，CGB处理逻辑');
            } else {
                console.log('只能处理1 000元以内的，领导审批')
                this.next && this.next.handleRes(money)
            }
        }
    }
    // 总经理
    class ZJLHandler extends Handler {
        handleRes(money) {
            if (money < 10000) {
                console.log('同意，ZJL处理逻辑');
            } else {
                console.log('只能处理10 000元以内的，领导审批')
                this.next && this.next.handleRes(money)
            }
        }
    }
    // 董事长
    class DSZHandler extends Handler {
        handleRes(money) {
            if (money >= 10000) {
                console.log('同意，我是大boss，我来处理');
            }
        }
    }

    // 构建职责链
    var cgb = new CGBHandler();
    var zjl = new ZJLHandler();
    var dsz = new DSZHandler();
    cgb.setNext(zjl);
    zjl.setNext(dsz);

    // 测试
    cgb.handleRes(1000);
```

###### 假如有董事长也没法处理的问题呢？请看下面的  说明。

##### 总结

```
职责链模式定义了请求的传递方向，通过多个对象对请求的传递，实现一个复杂的逻辑操作，因为职责链模式将
负责的需求颗粒逐一实现每一个对象分内的需求，并将请求顺序的传递，对于职责链上的每一个对象来说，它可
能是请求的发起者也可能是请求的接收者。通过这种这种方式就简化了原对象的复杂度，解决了原请求的发起者
与原请求接收者之前的耦合。
```

##### 说明

```
责任链模式，总的一个核心就是请求者不必知道是谁哪个节点对象处理的请求，由于处理请求的可以不同对象下
处理，所以请求者跟接受者是解耦的。

纯的责任链：要求请求在这些对象链中必须被处理，而且一个节点处理对象，要么只处理请求，要么把请求转发
给下个节点对象处理；

不纯的责任链：要求在责任链里不一定会有处理结构，而且一个节点对象，即可以处理部分请求，并把请求再转
发下个节点处理；
```

##### 结语

```javascript
技术交流，共同进步，欢迎fork和star！
```

