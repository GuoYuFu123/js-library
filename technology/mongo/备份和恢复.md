## 备份和恢复

### mongodump 和 mongorestore

#### mongodump

1. 打开终端或命令行工具，进入 `bin` 目录，即 `cd /usr/local/mongodb/bin`。

2. 使用 `mongodump` 命令，格式如下：

   ```bash
   mongodump --host <hostname> --port <port> --username <username> --password <password> --out <output directory>
   ```

   参数说明：

   - `--host`：MongoDB 主机名或 IP 地址，默认为 `localhost`。
   - `--port`：MongoDB 端口号，默认为 `27017`。
   - `--username`：MongoDB 用户名，如果没有设置用户认证，则不需要此参数。
   - `--password`：MongoDB 密码，如果没有设置用户认证，则不需要此参数。
   - `--out`：导出数据的输出目录，必须是一个不存在的目录。
   - --collection： 导出数据库中的某一个集合

   例如，如果要导出名为 `mydb` 的数据库，可以执行以下命令：

   ```bash
   mongodump --host localhost --port 27017 --db mydb --out /data/db/mydb-backup
   ```

   这将会将 `mydb` 数据库中的所有数据导出到 `/data/db/mydb-backup` 目录下。

注意：在执行 `mongodump` 命令之前，确保 MongoDB 服务已经启动。



#### mongorestore

可以使用 `mongorestore` 命令来恢复通过 `mongodump` 导出的数据，具体步骤如下：

1. 打开终端或命令行工具，进入 `bin` 目录，即 `cd /usr/local/mongodb/bin`。

2. 使用 `mongorestore` 命令，格式如下：

   ```bash
   mongorestore --host <hostname> --port <port> --username <username> --password <password> <input directory>
   ```

   参数说明：

   - `--host`：MongoDB 主机名或 IP 地址，默认为 `localhost`。
   - `--port`：MongoDB 端口号，默认为 `27017`。
   - `--username`：MongoDB 用户名，如果没有设置用户认证，则不需要此参数。
   - `--password`：MongoDB 密码，如果没有设置用户认证，则不需要此参数。
   - `<input directory>`：导出数据的输入目录，即 `mongodump` 命令导出数据的输出目录。

   例如，如果要将 `/data/db/mydb-backup` 目录下的 `mydb` 数据库数据恢复到 MongoDB 服务中，可以执行以下命令：

   ```bash
   mongorestore --host localhost --port 27017 /data/db/mydb-backup
   ```

   这将会将 `/data/db/mydb-backup` 目录下的 `mydb` 数据库数据恢复到 MongoDB 服务中。

注意：在执行 `mongorestore` 命令之前，确保 MongoDB 服务已经启动。





### mongoexport 和 mongoimport

#### mongoexport

`mongoexport` 命令可以将 MongoDB 中的数据导出为 JSON、CSV 或 TSV 格式，具体步骤如下：

1. 打开终端或命令行工具，进入 `bin` 目录，即 `cd /usr/local/mongodb/bin`。

2. 使用 `mongoexport` 命令，格式如下：

   ```bash
   mongoexport --host <hostname> --port <port> --username <username> --password <password> --db <database> --collection <collection> --type <export type> --out <output file>
   ```

   参数说明：

   - `--host`：MongoDB 主机名或 IP 地址，默认为 `localhost`。
   - `--port`：MongoDB 端口号，默认为 `27017`。
   - `--username`：MongoDB 用户名，如果没有设置用户认证，则不需要此参数。
   - `--password`：MongoDB 密码，如果没有设置用户认证，则不需要此参数。
   - `--db`：要导出数据的数据库名称。
   - `--collection`：要导出数据的集合名称。
   - `--type`：导出数据的格式，可选值为 `json`、`csv` 或 `tsv`。
   - `--out`：导出数据的输出文件名。

   例如，如果要将名为 `mydb` 数据库中的 `mycollection` 集合数据导出为 JSON 格式，可以执行以下命令：

   ```bash
   mongoexport --host localhost --port 27017 --db mydb --collection mycollection --type json --out /data/mycollection.json
   ```

   这将会将 `mydb` 数据库中的 `mycollection` 集合数据导出为 `/data/mycollection.json` 文件。

注意：在执行 `mongoexport` 命令之前，确保 MongoDB 服务已经启动。

#### mongoimport

`mongoimport` 命令可以将 JSON、CSV 或 TSV 格式的数据导入到 MongoDB 中，具体步骤如下：

1. 打开终端或命令行工具，进入 `bin` 目录，即 `cd /usr/local/mongodb/bin`。

2. 使用 `mongoimport` 命令，格式如下：

   ```bash
   mongoimport --host <hostname> --port <port> --username <username> --password <password> --db <database> --collection <collection> --type <import type> --file <input file>
   ```

   参数说明：

   - `--host`：MongoDB 主机名或 IP 地址，默认为 `localhost`。
   - `--port`：MongoDB 端口号，默认为 `27017`。
   - `--username`：MongoDB 用户名，如果没有设置用户认证，则不需要此参数。
   - `--password`：MongoDB 密码，如果没有设置用户认证，则不需要此参数。
   - `--db`：要导入数据的数据库名称。
   - `--collection`：要导入数据的集合名称。
   - `--type`：导入数据的格式，可选值为 `json`、`csv` 或 `tsv`。
   - `--file`：导入数据的输入文件名。

   例如，如果要将 `/data/mycollection.json` 文件中的数据导入到名为 `mydb` 数据库中的 `mycollection` 集合中，可以执行以下命令：

   ```bash
   mongoimport --host localhost --port 27017 --db mydb --collection mycollection --type json --file /data/mycollection.json
   ```

   这将会将 `/data/mycollection.json` 文件中的数据导入到 `mydb` 数据库中的 `mycollection` 集合中。

注意：在执行 `mongoimport` 命令之前，确保 MongoDB 服务已经启动。

### mongodump 和 monexport 的区别

`mongodump` 和 `mongoexport` 命令都可以用于导出 MongoDB 中的数据，但是它们有一些区别。

- `mongodump` 命令可以导出整个数据库或者一个集合的数据，并且导出的数据可以保留 MongoDB 内部的数据结构和索引等信息，导出的数据文件格式为 BSON。
- `mongoexport` 命令只能导出一个集合中的数据，并且导出的数据不包含 MongoDB 内部的数据结构和索引等信息，导出的数据文件格式为 JSON、CSV 或 TSV。

因此，如果需要备份整个数据库或者保留 MongoDB 内部的数据结构和索引等信息，可以使用 `mongodump` 命令；如果只需要导出一个集合中的数据，并且不需要保留 MongoDB 内部的数据结构和索引等信息，可以使用 `mongoexport` 命令。



















